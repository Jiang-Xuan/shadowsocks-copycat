2017-12-22 19:39:34 INFO     [5]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [5]: handle_event 客户端向服务端socket请求连接
2017-12-22 19:39:34 INFO     [5]: handle_event 服务器接受该请求, 并生成一个 socket[fd: 8] 和其通讯
2017-12-22 19:39:34 INFO     *** [8]: LIFECYCLE START ***
2017-12-22 19:39:34 INFO     [8]: 创建关于该请求的 TCPReplyHandler 并将其添加进 loop
2017-12-22 19:39:34 INFO     [8]: _get_a_server 方法来选择一个服务器
2017-12-22 19:39:34 INFO     [5]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 ]
2017-12-22 19:39:34 INFO     [8]: _handle_stage_init 处理该 local socket 的握手阶段 握手数据[0x05 0x01 0x00 ]
2017-12-22 19:39:34 INFO     [8]: _handle_stage_init 校验握手数据包(0x05 0x01 0x00 )成功, 写入响应握手包(\x05\x00)
2017-12-22 19:39:34 INFO     [8]: _handle_stage_init 握手包响应成功, 进入 STAGE_ADDR 阶段
2017-12-22 19:39:34 INFO     [5]: handle_event 客户端向服务端socket请求连接
2017-12-22 19:39:34 INFO     [5]: handle_event 服务器接受该请求, 并生成一个 socket[fd: 9] 和其通讯
2017-12-22 19:39:34 INFO     *** [9]: LIFECYCLE START ***
2017-12-22 19:39:34 INFO     [9]: 创建关于该请求的 TCPReplyHandler 并将其添加进 loop
2017-12-22 19:39:34 INFO     [9]: _get_a_server 方法来选择一个服务器
2017-12-22 19:39:34 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 ]
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr 处理该阶段的数据(0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 )
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr socks5 连接命令(\x01) 
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr data的解析结果(addrtype: 3, remote_addr: jiangxuan.org, remote_port: 3000, header_length: 17)
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr connecting jiangxuan.org:3000 from 127.0.0.1:65169
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr 进入 STAGE_DNS 阶段, 查询服务器的 IP地址
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr 响应给浏览器(\x05\x00\x00\x01\x00\x00\x00\x00\x00\x10\x10)成功, 将请求的地址加密(...)
2017-12-22 19:39:34 INFO     [8]: _handle_stage_addr 将加密后的数据存放到 _data_to_write_to_remote 之后调用 DNS 请求解析 ss 服务端地址
2017-12-22 19:39:34 INFO     请求解析的是 ip 地址 139.162.116.74, 直接返回
2017-12-22 19:39:34 INFO     [8]: _handle_dns_resolved DNS 解析完成(ip: 139.162.116.74, ip: 139.162.116.74)
2017-12-22 19:39:34 INFO     [8]: _handle_dns_resolved 进入 STAGE_CONNECTING 阶段, 开始连接 ss 服务端
2017-12-22 19:39:34 INFO     [8]: _handle_dns_resolved 创建连接 ss 服务端的 socket 
2017-12-22 19:39:34 INFO     ****** _create_remote_sock local_fd: [8] - remote_fd: [10] ******
2017-12-22 19:39:34 INFO     [8]: _handle_dns_resolved 连接 ss 服务端 的 socket(fd: [10]) 创建成功
2017-12-22 19:39:34 INFO     [8] - [10]: _handle_dns_resolved 调用 connect 方法尝试连接 ss 服务器
2017-12-22 19:39:34 INFO     [8] - [10]: _handle_dns_resolved 和 ss 服务器的连接还在创建中, 将 remote_sock 加入 loop 中
2017-12-22 19:39:34 INFO     [8] - [10]: _handle_dns_resolved 进入 STAGE_CONNECTING 中
2017-12-22 19:39:34 INFO     [9]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 ]
2017-12-22 19:39:34 INFO     [9]: _handle_stage_init 处理该 local socket 的握手阶段 握手数据[0x05 0x01 0x00 ]
2017-12-22 19:39:34 INFO     [9]: _handle_stage_init 校验握手数据包(0x05 0x01 0x00 )成功, 写入响应握手包(\x05\x00)
2017-12-22 19:39:34 INFO     [9]: _handle_stage_init 握手包响应成功, 进入 STAGE_ADDR 阶段
2017-12-22 19:39:34 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:39:34 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x47 0x45 0x54 0x20 0x2f 0x20 0x48 0x54 0x54 0x50 0x2f 0x31 0x2e 0x31 0x0d 0x0a 0x48 0x6f 0x73 0x74 0x3a 0x20 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x0d 0x0a 0x43 0x6f 0x6e 0x6e 0x65 0x63 0x74 0x69 0x6f 0x6e 0x3a 0x20 0x6b 0x65 0x65 0x70 0x2d 0x61 0x6c 0x69 0x76 0x65 0x0d 0x0a 0x43 0x61 0x63 0x68 0x65 0x2d 0x43 0x6f 0x6e 0x74 0x72 0x6f 0x6c 0x3a 0x20 0x6d 0x61 0x78 0x2d 0x61 0x67 0x65 0x3d 0x30 0x0d 0x0a 0x55 0x73 0x65 0x72 0x2d 0x41 0x67 0x65 0x6e 0x74 0x3a 0x20 0x4d 0x6f 0x7a 0x69 0x6c 0x6c 0x61 0x2f 0x35 0x2e 0x30 0x20 0x28 0x4d 0x61 0x63 0x69 0x6e 0x74 0x6f 0x73 0x68 0x3b 0x20 0x49 0x6e 0x74 0x65 0x6c 0x20 0x4d 0x61 0x63 0x20 0x4f 0x53 0x20 0x58 0x20 0x31 0x30 0x5f 0x31 0x33 0x5f 0x31 0x29 0x20 0x41 0x70 0x70 0x6c 0x65 0x57 0x65 0x62 0x4b 0x69 0x74 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x20 0x28 0x4b 0x48 0x54 0x4d 0x4c 0x2c 0x20 0x6c 0x69 0x6b 0x65 0x20 0x47 0x65 0x63 0x6b 0x6f 0x29 0x20 0x43 0x68 0x72 0x6f 0x6d 0x65 0x2f 0x36 0x33 0x2e 0x30 0x2e 0x33 0x32 0x33 0x39 0x2e 0x31 0x30 0x38 0x20 0x53 0x61 0x66 0x61 0x72 0x69 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x0d 0x0a 0x55 0x70 0x67 0x72 0x61 0x64 0x65 0x2d 0x49 0x6e 0x73 0x65 0x63 0x75 0x72 0x65 0x2d 0x52 0x65 0x71 0x75 0x65 0x73 0x74 0x73 0x3a 0x20 0x31 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x3a 0x20 0x74 0x65 0x78 0x74 0x2f 0x68 0x74 0x6d 0x6c 0x2c 0x61 0x70 0x70 0x6c 0x69 0x63 0x61 0x74 0x69 0x6f 0x6e 0x2f 0x78 0x68 0x74 0x6d 0x6c 0x2b 0x78 0x6d 0x6c 0x2c 0x61 0x70 0x70 0x6c 0x69 0x63 0x61 0x74 0x69 0x6f 0x6e 0x2f 0x78 0x6d 0x6c 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x77 0x65 0x62 0x70 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x61 0x70 0x6e 0x67 0x2c 0x2a 0x2f 0x2a 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x45 0x6e 0x63 0x6f 0x64 0x69 0x6e 0x67 0x3a 0x20 0x67 0x7a 0x69 0x70 0x2c 0x20 0x64 0x65 0x66 0x6c 0x61 0x74 0x65 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x4c 0x61 0x6e 0x67 0x75 0x61 0x67 0x65 0x3a 0x20 0x7a 0x68 0x2d 0x43 0x4e 0x2c 0x7a 0x68 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x65 0x6e 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x0d 0x0a ]
2017-12-22 19:39:34 INFO     [8] - [10]: _handle_stage_connecting 处理 STAGE_CONNECTING 阶段的数据(GET / HTTP/1.1 Host: jiangxuan.org:3000 Connection: keep-alive Cache-Control: max-age=0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36 Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8  )
2017-12-22 19:39:34 INFO     [8] - [10]: _handle_stage_connecting 加密后数据(...) 数据被添加进 _data_to_write_to_remote 因为此时 remote_sock[fd: 10] 还没有建立连接, 一旦建立连接, 走的就是 STAGE_STREAM 逻辑
2017-12-22 19:39:34 INFO     [9]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 ]
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr 处理该阶段的数据(0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 )
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr socks5 连接命令(\x01) 
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr data的解析结果(addrtype: 3, remote_addr: jiangxuan.org, remote_port: 3000, header_length: 17)
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr connecting jiangxuan.org:3000 from 127.0.0.1:65170
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr 进入 STAGE_DNS 阶段, 查询服务器的 IP地址
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr 响应给浏览器(\x05\x00\x00\x01\x00\x00\x00\x00\x00\x10\x10)成功, 将请求的地址加密(...)
2017-12-22 19:39:34 INFO     [9]: _handle_stage_addr 将加密后的数据存放到 _data_to_write_to_remote 之后调用 DNS 请求解析 ss 服务端地址
2017-12-22 19:39:34 INFO     请求解析的是 ip 地址 139.162.116.74, 直接返回
2017-12-22 19:39:34 INFO     [9]: _handle_dns_resolved DNS 解析完成(ip: 139.162.116.74, ip: 139.162.116.74)
2017-12-22 19:39:34 INFO     [9]: _handle_dns_resolved 进入 STAGE_CONNECTING 阶段, 开始连接 ss 服务端
2017-12-22 19:39:34 INFO     [9]: _handle_dns_resolved 创建连接 ss 服务端的 socket 
2017-12-22 19:39:34 INFO     ****** _create_remote_sock local_fd: [9] - remote_fd: [11] ******
2017-12-22 19:39:34 INFO     [9]: _handle_dns_resolved 连接 ss 服务端 的 socket(fd: [11]) 创建成功
2017-12-22 19:39:34 INFO     [9] - [11]: _handle_dns_resolved 调用 connect 方法尝试连接 ss 服务器
2017-12-22 19:39:34 INFO     [9] - [11]: _handle_dns_resolved 和 ss 服务器的连接还在创建中, 将 remote_sock 加入 loop 中
2017-12-22 19:39:34 INFO     [9] - [11]: _handle_dns_resolved 进入 STAGE_CONNECTING 中
2017-12-22 19:39:34 INFO     [10]: poll 数据可写事件发生
2017-12-22 19:39:34 INFO     [8] - [10]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:39:34 INFO     [8] - [10]: handle_event _remote_sock 触发 POLL_OUT 写入 remote 数据 => _on_remote_write
2017-12-22 19:39:34 INFO     [8] -[10]: _on_remote_write _data_to_write_to_remote中的数据写向 _remote_sock 此时远程连接成功建立, 进入 STAGE_STREAM 阶段
2017-12-22 19:39:34 INFO     [8] - [10]: _on_remote_write _data_to_write_to_remote有数据, 拼起来, 置空_data_to_write_to_remote, 将拼起来的数据写向 _remote_sock
2017-12-22 19:39:34 INFO     [11]: poll 数据可写事件发生
2017-12-22 19:39:34 INFO     [9] - [11]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:39:34 INFO     [9] - [11]: handle_event _remote_sock 触发 POLL_OUT 写入 remote 数据 => _on_remote_write
2017-12-22 19:39:34 INFO     [9] -[11]: _on_remote_write _data_to_write_to_remote中的数据写向 _remote_sock 此时远程连接成功建立, 进入 STAGE_STREAM 阶段
2017-12-22 19:39:34 INFO     [9] - [11]: _on_remote_write _data_to_write_to_remote有数据, 拼起来, 置空_data_to_write_to_remote, 将拼起来的数据写向 _remote_sock
2017-12-22 19:39:35 INFO     [10]: poll 数据可读事件发生
2017-12-22 19:39:35 INFO     [8] - [10]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:39:35 INFO     [8] - [10]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:39:35 INFO     [8] - [10]: _on_remote_read 从远程读取数据
2017-12-22 19:39:35 INFO     [8] - [10]: _on_remote_read 从远程读取数据成功
2017-12-22 19:39:35 INFO     [8] - [10]: _on_remote_read 解密从远程读取的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:39:34 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)
2017-12-22 19:39:35 INFO     [8] - [10]: _on_remote_read try将解密过后的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:39:34 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)写向 _local_sock
2017-12-22 19:39:36 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:39:36 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x47 0x45 0x54 0x20 0x2f 0x66 0x61 0x76 0x69 0x63 0x6f 0x6e 0x2e 0x69 0x63 0x6f 0x20 0x48 0x54 0x54 0x50 0x2f 0x31 0x2e 0x31 0x0d 0x0a 0x48 0x6f 0x73 0x74 0x3a 0x20 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x0d 0x0a 0x43 0x6f 0x6e 0x6e 0x65 0x63 0x74 0x69 0x6f 0x6e 0x3a 0x20 0x6b 0x65 0x65 0x70 0x2d 0x61 0x6c 0x69 0x76 0x65 0x0d 0x0a 0x50 0x72 0x61 0x67 0x6d 0x61 0x3a 0x20 0x6e 0x6f 0x2d 0x63 0x61 0x63 0x68 0x65 0x0d 0x0a 0x43 0x61 0x63 0x68 0x65 0x2d 0x43 0x6f 0x6e 0x74 0x72 0x6f 0x6c 0x3a 0x20 0x6e 0x6f 0x2d 0x63 0x61 0x63 0x68 0x65 0x0d 0x0a 0x55 0x73 0x65 0x72 0x2d 0x41 0x67 0x65 0x6e 0x74 0x3a 0x20 0x4d 0x6f 0x7a 0x69 0x6c 0x6c 0x61 0x2f 0x35 0x2e 0x30 0x20 0x28 0x4d 0x61 0x63 0x69 0x6e 0x74 0x6f 0x73 0x68 0x3b 0x20 0x49 0x6e 0x74 0x65 0x6c 0x20 0x4d 0x61 0x63 0x20 0x4f 0x53 0x20 0x58 0x20 0x31 0x30 0x5f 0x31 0x33 0x5f 0x31 0x29 0x20 0x41 0x70 0x70 0x6c 0x65 0x57 0x65 0x62 0x4b 0x69 0x74 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x20 0x28 0x4b 0x48 0x54 0x4d 0x4c 0x2c 0x20 0x6c 0x69 0x6b 0x65 0x20 0x47 0x65 0x63 0x6b 0x6f 0x29 0x20 0x43 0x68 0x72 0x6f 0x6d 0x65 0x2f 0x36 0x33 0x2e 0x30 0x2e 0x33 0x32 0x33 0x39 0x2e 0x31 0x30 0x38 0x20 0x53 0x61 0x66 0x61 0x72 0x69 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x3a 0x20 0x69 0x6d 0x61 0x67 0x65 0x2f 0x77 0x65 0x62 0x70 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x61 0x70 0x6e 0x67 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x2a 0x2c 0x2a 0x2f 0x2a 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x52 0x65 0x66 0x65 0x72 0x65 0x72 0x3a 0x20 0x68 0x74 0x74 0x70 0x3a 0x2f 0x2f 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x2f 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x45 0x6e 0x63 0x6f 0x64 0x69 0x6e 0x67 0x3a 0x20 0x67 0x7a 0x69 0x70 0x2c 0x20 0x64 0x65 0x66 0x6c 0x61 0x74 0x65 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x4c 0x61 0x6e 0x67 0x75 0x61 0x67 0x65 0x3a 0x20 0x7a 0x68 0x2d 0x43 0x4e 0x2c 0x7a 0x68 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x65 0x6e 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x0d 0x0a ]
2017-12-22 19:39:36 INFO     [8] - [10]: _handle_stage_stream STAGE_STREAM 阶段, 直接将数据(GET /favicon.ico HTTP/1.1 Host: jiangxuan.org:3000 Connection: keep-alive Pragma: no-cache Cache)加密后写向 _remote_sock
2017-12-22 19:39:36 INFO     [10]: poll 数据可读事件发生
2017-12-22 19:39:36 INFO     [8] - [10]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:39:36 INFO     [8] - [10]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:39:36 INFO     [8] - [10]: _on_remote_read 从远程读取数据
2017-12-22 19:39:36 INFO     [8] - [10]: _on_remote_read 从远程读取数据成功
2017-12-22 19:39:36 INFO     [8] - [10]: _on_remote_read 解密从远程读取的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:39:36 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)
2017-12-22 19:39:36 INFO     [8] - [10]: _on_remote_read try将解密过后的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:39:36 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)写向 _local_sock
2017-12-22 19:39:41 INFO     [10]: poll 数据可读事件发生
2017-12-22 19:39:41 INFO     [8] - [10]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:39:41 INFO     [8] - [10]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:39:41 INFO     [8] - [10]: _on_remote_read 从远程读取数据
2017-12-22 19:39:41 INFO     [8] - [10]: _on_remote_read 从远程读取数据成功
2017-12-22 19:39:41 INFO     [8] - [10]: _on_remote_read 远程读取数据()为空, 远程已经关闭了连接 调用销毁函数 destroy
2017-12-22 19:39:41 DEBUG    destroy: jiangxuan.org:3000
2017-12-22 19:39:41 DEBUG    destroying remote
2017-12-22 19:39:41 DEBUG    destroy local
2017-12-22 19:39:41 INFO     *** [8]: LIFECYCLE END ***
2017-12-22 19:40:37 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [9]: _on_local_read local 数据被读取 数据为: []
2017-12-22 19:40:37 DEBUG    destroy: jiangxuan.org:3000
2017-12-22 19:40:37 DEBUG    destroying remote
2017-12-22 19:40:37 DEBUG    destroy local
2017-12-22 19:40:37 INFO     *** [9]: LIFECYCLE END ***
2017-12-22 19:40:37 INFO     [5]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [5]: handle_event 客户端向服务端socket请求连接
2017-12-22 19:40:37 INFO     [5]: handle_event 服务器接受该请求, 并生成一个 socket[fd: 8] 和其通讯
2017-12-22 19:40:37 INFO     *** [8]: LIFECYCLE START ***
2017-12-22 19:40:37 INFO     [8]: 创建关于该请求的 TCPReplyHandler 并将其添加进 loop
2017-12-22 19:40:37 INFO     [8]: _get_a_server 方法来选择一个服务器
2017-12-22 19:40:37 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 ]
2017-12-22 19:40:37 INFO     [8]: _handle_stage_init 处理该 local socket 的握手阶段 握手数据[0x05 0x01 0x00 ]
2017-12-22 19:40:37 INFO     [8]: _handle_stage_init 校验握手数据包(0x05 0x01 0x00 )成功, 写入响应握手包(\x05\x00)
2017-12-22 19:40:37 INFO     [8]: _handle_stage_init 握手包响应成功, 进入 STAGE_ADDR 阶段
2017-12-22 19:40:37 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 ]
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr 处理该阶段的数据(0x05 0x01 0x00 0x03 0x0d 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x0b 0xb8 )
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr socks5 连接命令(\x01) 
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr data的解析结果(addrtype: 3, remote_addr: jiangxuan.org, remote_port: 3000, header_length: 17)
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr connecting jiangxuan.org:3000 from 127.0.0.1:65416
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr 进入 STAGE_DNS 阶段, 查询服务器的 IP地址
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr 响应给浏览器(\x05\x00\x00\x01\x00\x00\x00\x00\x00\x10\x10)成功, 将请求的地址加密(...)
2017-12-22 19:40:37 INFO     [8]: _handle_stage_addr 将加密后的数据存放到 _data_to_write_to_remote 之后调用 DNS 请求解析 ss 服务端地址
2017-12-22 19:40:37 INFO     请求解析的是 ip 地址 139.162.116.74, 直接返回
2017-12-22 19:40:37 INFO     [8]: _handle_dns_resolved DNS 解析完成(ip: 139.162.116.74, ip: 139.162.116.74)
2017-12-22 19:40:37 INFO     [8]: _handle_dns_resolved 进入 STAGE_CONNECTING 阶段, 开始连接 ss 服务端
2017-12-22 19:40:37 INFO     [8]: _handle_dns_resolved 创建连接 ss 服务端的 socket 
2017-12-22 19:40:37 INFO     ****** _create_remote_sock local_fd: [8] - remote_fd: [9] ******
2017-12-22 19:40:37 INFO     [8]: _handle_dns_resolved 连接 ss 服务端 的 socket(fd: [9]) 创建成功
2017-12-22 19:40:37 INFO     [8] - [9]: _handle_dns_resolved 调用 connect 方法尝试连接 ss 服务器
2017-12-22 19:40:37 INFO     [8] - [9]: _handle_dns_resolved 和 ss 服务器的连接还在创建中, 将 remote_sock 加入 loop 中
2017-12-22 19:40:37 INFO     [8] - [9]: _handle_dns_resolved 进入 STAGE_CONNECTING 中
2017-12-22 19:40:37 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x47 0x45 0x54 0x20 0x2f 0x20 0x48 0x54 0x54 0x50 0x2f 0x31 0x2e 0x31 0x0d 0x0a 0x48 0x6f 0x73 0x74 0x3a 0x20 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x0d 0x0a 0x43 0x6f 0x6e 0x6e 0x65 0x63 0x74 0x69 0x6f 0x6e 0x3a 0x20 0x6b 0x65 0x65 0x70 0x2d 0x61 0x6c 0x69 0x76 0x65 0x0d 0x0a 0x43 0x61 0x63 0x68 0x65 0x2d 0x43 0x6f 0x6e 0x74 0x72 0x6f 0x6c 0x3a 0x20 0x6d 0x61 0x78 0x2d 0x61 0x67 0x65 0x3d 0x30 0x0d 0x0a 0x55 0x70 0x67 0x72 0x61 0x64 0x65 0x2d 0x49 0x6e 0x73 0x65 0x63 0x75 0x72 0x65 0x2d 0x52 0x65 0x71 0x75 0x65 0x73 0x74 0x73 0x3a 0x20 0x31 0x0d 0x0a 0x55 0x73 0x65 0x72 0x2d 0x41 0x67 0x65 0x6e 0x74 0x3a 0x20 0x4d 0x6f 0x7a 0x69 0x6c 0x6c 0x61 0x2f 0x35 0x2e 0x30 0x20 0x28 0x4d 0x61 0x63 0x69 0x6e 0x74 0x6f 0x73 0x68 0x3b 0x20 0x49 0x6e 0x74 0x65 0x6c 0x20 0x4d 0x61 0x63 0x20 0x4f 0x53 0x20 0x58 0x20 0x31 0x30 0x5f 0x31 0x33 0x5f 0x31 0x29 0x20 0x41 0x70 0x70 0x6c 0x65 0x57 0x65 0x62 0x4b 0x69 0x74 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x20 0x28 0x4b 0x48 0x54 0x4d 0x4c 0x2c 0x20 0x6c 0x69 0x6b 0x65 0x20 0x47 0x65 0x63 0x6b 0x6f 0x29 0x20 0x43 0x68 0x72 0x6f 0x6d 0x65 0x2f 0x36 0x33 0x2e 0x30 0x2e 0x33 0x32 0x33 0x39 0x2e 0x31 0x30 0x38 0x20 0x53 0x61 0x66 0x61 0x72 0x69 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x3a 0x20 0x74 0x65 0x78 0x74 0x2f 0x68 0x74 0x6d 0x6c 0x2c 0x61 0x70 0x70 0x6c 0x69 0x63 0x61 0x74 0x69 0x6f 0x6e 0x2f 0x78 0x68 0x74 0x6d 0x6c 0x2b 0x78 0x6d 0x6c 0x2c 0x61 0x70 0x70 0x6c 0x69 0x63 0x61 0x74 0x69 0x6f 0x6e 0x2f 0x78 0x6d 0x6c 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x77 0x65 0x62 0x70 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x61 0x70 0x6e 0x67 0x2c 0x2a 0x2f 0x2a 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x45 0x6e 0x63 0x6f 0x64 0x69 0x6e 0x67 0x3a 0x20 0x67 0x7a 0x69 0x70 0x2c 0x20 0x64 0x65 0x66 0x6c 0x61 0x74 0x65 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x4c 0x61 0x6e 0x67 0x75 0x61 0x67 0x65 0x3a 0x20 0x7a 0x68 0x2d 0x43 0x4e 0x2c 0x7a 0x68 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x65 0x6e 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x0d 0x0a ]
2017-12-22 19:40:37 INFO     [8] - [9]: _handle_stage_connecting 处理 STAGE_CONNECTING 阶段的数据(GET / HTTP/1.1 Host: jiangxuan.org:3000 Connection: keep-alive Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8  )
2017-12-22 19:40:37 INFO     [8] - [9]: _handle_stage_connecting 加密后数据(...) 数据被添加进 _data_to_write_to_remote 因为此时 remote_sock[fd: 9] 还没有建立连接, 一旦建立连接, 走的就是 STAGE_STREAM 逻辑
2017-12-22 19:40:37 INFO     [9]: poll 数据可写事件发生
2017-12-22 19:40:37 INFO     [8] - [9]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:40:37 INFO     [8] - [9]: handle_event _remote_sock 触发 POLL_OUT 写入 remote 数据 => _on_remote_write
2017-12-22 19:40:37 INFO     [8] -[9]: _on_remote_write _data_to_write_to_remote中的数据写向 _remote_sock 此时远程连接成功建立, 进入 STAGE_STREAM 阶段
2017-12-22 19:40:37 INFO     [8] - [9]: _on_remote_write _data_to_write_to_remote有数据, 拼起来, 置空_data_to_write_to_remote, 将拼起来的数据写向 _remote_sock
2017-12-22 19:40:37 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:40:37 INFO     [8] - [9]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:40:37 INFO     [8] - [9]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:40:37 INFO     [8] - [9]: _on_remote_read 从远程读取数据
2017-12-22 19:40:37 INFO     [8] - [9]: _on_remote_read 从远程读取数据成功
2017-12-22 19:40:37 INFO     [8] - [9]: _on_remote_read 解密从远程读取的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:40:37 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)
2017-12-22 19:40:37 INFO     [8] - [9]: _on_remote_read try将解密过后的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:40:37 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)写向 _local_sock
2017-12-22 19:40:38 INFO     [8]: poll 数据可读事件发生
2017-12-22 19:40:38 INFO     [8]: _on_local_read local 数据被读取 数据为: [0x47 0x45 0x54 0x20 0x2f 0x66 0x61 0x76 0x69 0x63 0x6f 0x6e 0x2e 0x69 0x63 0x6f 0x20 0x48 0x54 0x54 0x50 0x2f 0x31 0x2e 0x31 0x0d 0x0a 0x48 0x6f 0x73 0x74 0x3a 0x20 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x0d 0x0a 0x43 0x6f 0x6e 0x6e 0x65 0x63 0x74 0x69 0x6f 0x6e 0x3a 0x20 0x6b 0x65 0x65 0x70 0x2d 0x61 0x6c 0x69 0x76 0x65 0x0d 0x0a 0x55 0x73 0x65 0x72 0x2d 0x41 0x67 0x65 0x6e 0x74 0x3a 0x20 0x4d 0x6f 0x7a 0x69 0x6c 0x6c 0x61 0x2f 0x35 0x2e 0x30 0x20 0x28 0x4d 0x61 0x63 0x69 0x6e 0x74 0x6f 0x73 0x68 0x3b 0x20 0x49 0x6e 0x74 0x65 0x6c 0x20 0x4d 0x61 0x63 0x20 0x4f 0x53 0x20 0x58 0x20 0x31 0x30 0x5f 0x31 0x33 0x5f 0x31 0x29 0x20 0x41 0x70 0x70 0x6c 0x65 0x57 0x65 0x62 0x4b 0x69 0x74 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x20 0x28 0x4b 0x48 0x54 0x4d 0x4c 0x2c 0x20 0x6c 0x69 0x6b 0x65 0x20 0x47 0x65 0x63 0x6b 0x6f 0x29 0x20 0x43 0x68 0x72 0x6f 0x6d 0x65 0x2f 0x36 0x33 0x2e 0x30 0x2e 0x33 0x32 0x33 0x39 0x2e 0x31 0x30 0x38 0x20 0x53 0x61 0x66 0x61 0x72 0x69 0x2f 0x35 0x33 0x37 0x2e 0x33 0x36 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x3a 0x20 0x69 0x6d 0x61 0x67 0x65 0x2f 0x77 0x65 0x62 0x70 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x61 0x70 0x6e 0x67 0x2c 0x69 0x6d 0x61 0x67 0x65 0x2f 0x2a 0x2c 0x2a 0x2f 0x2a 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x52 0x65 0x66 0x65 0x72 0x65 0x72 0x3a 0x20 0x68 0x74 0x74 0x70 0x3a 0x2f 0x2f 0x6a 0x69 0x61 0x6e 0x67 0x78 0x75 0x61 0x6e 0x2e 0x6f 0x72 0x67 0x3a 0x33 0x30 0x30 0x30 0x2f 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x45 0x6e 0x63 0x6f 0x64 0x69 0x6e 0x67 0x3a 0x20 0x67 0x7a 0x69 0x70 0x2c 0x20 0x64 0x65 0x66 0x6c 0x61 0x74 0x65 0x0d 0x0a 0x41 0x63 0x63 0x65 0x70 0x74 0x2d 0x4c 0x61 0x6e 0x67 0x75 0x61 0x67 0x65 0x3a 0x20 0x7a 0x68 0x2d 0x43 0x4e 0x2c 0x7a 0x68 0x3b 0x71 0x3d 0x30 0x2e 0x39 0x2c 0x65 0x6e 0x3b 0x71 0x3d 0x30 0x2e 0x38 0x0d 0x0a 0x0d 0x0a ]
2017-12-22 19:40:38 INFO     [8] - [9]: _handle_stage_stream STAGE_STREAM 阶段, 直接将数据(GET /favicon.ico HTTP/1.1 Host: jiangxuan.org:3000 Connection: keep-alive User-Agent: Mozilla/5.0)加密后写向 _remote_sock
2017-12-22 19:40:38 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:40:38 INFO     [8] - [9]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:40:38 INFO     [8] - [9]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:40:38 INFO     [8] - [9]: _on_remote_read 从远程读取数据
2017-12-22 19:40:38 INFO     [8] - [9]: _on_remote_read 从远程读取数据成功
2017-12-22 19:40:38 INFO     [8] - [9]: _on_remote_read 解密从远程读取的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:40:38 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)
2017-12-22 19:40:38 INFO     [8] - [9]: _on_remote_read try将解密过后的数据(HTTP/1.1 405 Method Not Allowed Content-Type: text/html Date: Fri, 22 Dec 2017 11:40:38 GMT Connection: keep-alive Content-Length: 20  Method not allowed.
)写向 _local_sock
2017-12-22 19:40:43 INFO     [9]: poll 数据可读事件发生
2017-12-22 19:40:43 INFO     [8] - [9]: handle_event 触发事件的是 _remote_sock
2017-12-22 19:40:43 INFO     [8] - [9]: handle_event _remote_sock 触发 POLL_IN 读取 remote 数据 => _on_remote_read
2017-12-22 19:40:43 INFO     [8] - [9]: _on_remote_read 从远程读取数据
2017-12-22 19:40:43 INFO     [8] - [9]: _on_remote_read 从远程读取数据成功
2017-12-22 19:40:43 INFO     [8] - [9]: _on_remote_read 远程读取数据()为空, 远程已经关闭了连接 调用销毁函数 destroy
2017-12-22 19:40:43 DEBUG    destroy: jiangxuan.org:3000
2017-12-22 19:40:43 DEBUG    destroying remote
2017-12-22 19:40:43 DEBUG    destroy local
2017-12-22 19:40:43 INFO     *** [8]: LIFECYCLE END ***
